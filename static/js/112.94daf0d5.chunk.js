(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{440:function(n,s,a){"use strict";a.r(s),a.d(s,"readingTime",function(){return o}),a.d(s,"default",function(){return l}),a.d(s,"tableOfContents",function(){return u}),a.d(s,"frontMatter",function(){return i});var t=a(32),p=(a(0),a(44)),o={text:"5 min read",minutes:4.59,time:275400,words:918},e={},c="wrapper";function l(n){var s=n.components,a=Object(t.a)(n,["components"]);return Object(p.b)(c,Object.assign({},e,a,{components:s,mdxType:"MDXLayout"}),Object(p.b)("h2",{id:"\u5e27\u52a8\u753b\u95ea\u70c1\u548c\u6d4f\u89c8\u5668\u517c\u5bb9\u6027"},"\u5e27\u52a8\u753b\u95ea\u70c1\u548c\u6d4f\u89c8\u5668\u517c\u5bb9\u6027"),Object(p.b)("p",null,"\u5206\u4e3a\u89c4\u5219\u95ea\u70c1\u548c\u4e0d\u89c4\u5219\u95ea\u70c1\u4e24\u79cd\u3002"),Object(p.b)("p",null,"1.\u89c4\u5219\u95ea\u70c1"),Object(p.b)("p",null,"\u89c4\u5219\u95ea\u70c1\u5728\u4e0d\u540c\u6d4f\u89c8\u5668\u8868\u73b0\u4e0d\u4e00\u6837\u3002chrome\u3001ie\u3001edge \u5404\u81ea\u6709\u5404\u81ea\u7684\u95ee\u9898\u3002"),Object(p.b)("p",null,"1\u3001\u56fe\u7247\u5220\u9664\u3001\u63d2\u5165\u5f0f\u7684\u52a8\u753b\u65b9\u5f0f\uff0c\u5728 ie11 \u4e0a\u4f1a\u95ea\u70c1\u3002"),Object(p.b)("p",null,"2\u3001\u66ff\u6362\u56fe\u7247 src \u7684\u52a8\u753b\u65b9\u5f0f\uff0c\u5728 edge \u4e0a\u4f1a\u95ea\u70c1\u3002"),Object(p.b)("p",null,"3\u3001\u66ff\u6362\u80cc\u666f\u56fe\u4e5f\u5728 chrome \u6709\u4e0d\u540c\u7a0b\u5ea6\u7684\u95ee\u9898\u3002"),Object(p.b)("p",null,"\u6478\u7d22\u4e0b\u6765\uff0c\u9009\u62e9\u4e86\u65b9\u6848 2\uff0c\u7136\u540e\u5728 edge \u4e0a\u505a\u8bd5\u9a8c\uff0c\u5bfb\u627e\u5f15\u8d77\u95ea\u70c1\u7684\u539f\u56e0\u5c1d\u8bd5\u4fee\u590d\u3002\n\u76ee\u524d\u6ca1\u6709\u4e25\u683c\u51c6\u786e\u7684\u7ed3\u8bba\uff0c\u4f46\u5bf9\u56fe\u7247",Object(p.b)("inlineCode",{parentName:"p"},"\u538b\u7f29\u5c3a\u5bf8"),"\u540e\uff0c\u95ea\u70c1\u5c31\u6d88\u5931\u4e86\uff08",Object(p.b)("inlineCode",{parentName:"p"},"png\u538b\u7f29\u540e\u635f\u5931alpha\u901a\u9053\uff0c\u4e22\u5931\u900f\u660e\u5ea6"),"\uff09\u3002\u521d\u6b65\u7ed3\u8bba edge \u6e32\u67d3\u6548\u80fd\u6709\u95ee\u9898\u3002"),Object(p.b)("p",null,"2.\u4e0d\u89c4\u5219\u95ea\u70c1"),Object(p.b)("p",null,"\u4e0e\u6d4f\u89c8\u5668\u65e0\u5173\uff0c\u90fd\u4f1a\u53d1\u751f\u3002\u5728\u5237\u65b0\u9875\u9762\u6216\u8005\u5207\u9875\u9762\u65f6\u5bb9\u6613\u51fa\u73b0\uff0c\u4e3b\u8981\u539f\u56e0\u662f\u201c\u91cd\u5165\u201d\u3002"),Object(p.b)("h2",{id:"webpack-\u4e0e\u8c03\u8bd5-es5"},"webpack \u4e0e\u8c03\u8bd5 es5"),Object(p.b)("p",null,"\u53c2\u8003",Object(p.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/jaredpalmer/razzle/issues/998#issuecomment-576892323"}),"\u672c\u6587"),"\uff0c\u901a\u8fc7\u4fee\u6539 webpack \u7684 dev server \u914d\u7f6e\uff0c\u4f7f\u5f97client\u4f7f\u7528webpack/hot/dev-server\uff0c\u53ef\u4ee5\u5b9e\u65f6\u7f16\u8bd1\u6210 es5 \u7ed9 IE \u8c03\u8bd5\u3002 \u63d0\u9ad8\u4e86\u8c03\u8bd5\u6548\u7387\uff0c\u5c24\u5176\u662fIE11\u3002"),Object(p.b)("p",null,"\u95ee\uff1a",Object(p.b)("inlineCode",{parentName:"p"},"webpack/hot/dev-server"),"\u600e\u4e48\u77e5\u9053\u8be5\u7f16\u8bd1\u6210 es5\uff1f"),Object(p.b)("p",null,"\u7b54\uff1a\u57fa\u4e8epackage.json\u7684",Object(p.b)("inlineCode",{parentName:"p"},"browserslist\u914d\u7f6e"),"\u3002"),Object(p.b)("p",null,"\u6e90\u7801\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff1a"),Object(p.b)("pre",null,Object(p.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx","data-language":"jsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token comment">// node_modules/razzle/config/createConfig.js</span>\n<span class="token comment">// line 381</span>\nconfig<span class="token punctuation">.</span>entry <span class="token operator">=</span> <span class="token punctuation">{</span>\n    client<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n<span class="highlighted-line">        require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">\'razzle-dev-utils/webpackHotDevClient\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span><span class="highlighted-line">        <span class="token comment">// \u5c06\u4e0a\u9762\u8fd9\u884c\u66ff\u6362\u6210require.resolve(\'webpack/hot/dev-server\')</span></span>        paths<span class="token punctuation">.</span>appClientIndexJs\n    <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n'}}))),Object(p.b)("p",null,"\u5177\u4f53\u6b65\u9aa4\uff1a"),Object(p.b)("p",null,"1.razzle\u914d\u7f6e\u5316\u4fee\u6539"),Object(p.b)("pre",null,Object(p.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx","data-language":"jsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token comment">// razzle.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span>\n            name<span class="token punctuation">:</span> <span class="token string">\'typescript\'</span><span class="token punctuation">,</span>\n            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n                useBabel<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n                tsLoader<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n                    transpileOnly<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n                    experimentalWatchApi<span class="token punctuation">:</span> <span class="token boolean">true</span>\n                <span class="token punctuation">}</span><span class="token punctuation">,</span>\n                forkTsChecker<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n                    tsconfig<span class="token punctuation">:</span> <span class="token string">\'./tsconfig.json\'</span><span class="token punctuation">,</span>\n                    tslint<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n                    watch<span class="token punctuation">:</span> <span class="token string">\'./src\'</span><span class="token punctuation">,</span>\n                    typeCheck<span class="token punctuation">:</span> <span class="token boolean">true</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="highlighted-line">    <span class="token function-variable function">modify</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span> <span class="token punctuation">{</span>target<span class="token punctuation">,</span> dev<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><span class="highlighted-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>dev <span class="token operator">&amp;&amp;</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ECMA</span> <span class="token operator">===</span> <span class="token string">\'5\'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="highlighted-line">            <span class="token comment">// \u8fd9\u91ccECMA\u662f\u73af\u5883\u53d8\u91cf\u63a7\u5236\u7684\u529f\u80fd\u5f00\u5173</span></span><span class="highlighted-line">            config<span class="token punctuation">.</span>entry<span class="token punctuation">.</span>client<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">\'webpack/hot/dev-server\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="highlighted-line">        <span class="token punctuation">}</span></span><span class="highlighted-line"></span><span class="highlighted-line">        <span class="token keyword">return</span> config<span class="token punctuation">;</span></span><span class="highlighted-line">    <span class="token punctuation">}</span></span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n'}}))),Object(p.b)("p",null,"2.\u589e\u52a0\u5e26\u529f\u80fd\u5f00\u5173\u7684\u811a\u672c\uff0c\u914d\u7f6e\u6b63\u786e\u7684browserslist\u3002"),Object(p.b)("pre",null,Object(p.b)("code",Object.assign({parentName:"pre"},{className:"language-json","data-language":"json","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token comment">// package.json</span>\n<span class="token punctuation">{</span>\n    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cra-ts-ssr-zero"</span><span class="token punctuation">,</span>\n    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n    <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"MIT"</span><span class="token punctuation">,</span>\n    <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token property">"new:component"</span><span class="token operator">:</span> <span class="token string">"hygen component new"</span><span class="token punctuation">,</span>\n        <span class="token property">"new:page"</span><span class="token operator">:</span> <span class="token string">"hygen page new"</span><span class="token punctuation">,</span>\n        <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"PUBLIC_PATH=./ CLIENT_PUBLIC_PATH=/ razzle start --type=spa"</span><span class="token punctuation">,</span>\n<span class="highlighted-line">        <span class="token property">"start:es5"</span><span class="token operator">:</span> <span class="token string">"PUBLIC_PATH=./ CLIENT_PUBLIC_PATH=/ ECMA=5 razzle start --type=spa"</span><span class="token punctuation">,</span></span>        <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"PUBLIC_PATH=./ razzle build --type=spa"</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">"browserslist"</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token string">">0.2%"</span><span class="token punctuation">,</span>\n        <span class="token string">"not dead"</span><span class="token punctuation">,</span>\n        <span class="token string">"not ie &lt;= 11"</span><span class="token punctuation">,</span>\n        <span class="token string">"not op_mini all"</span><span class="token punctuation">,</span>\n        <span class="token string">"chrome >=51"</span>\n    <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n'}}))),Object(p.b)("h2",{id:"ie11-css\u517c\u5bb9\u6027\u76f8\u5173"},"IE11 CSS\u517c\u5bb9\u6027\u76f8\u5173"),Object(p.b)("p",null,"\u5728\u505a\u5e03\u5c40\u7684\u65f6\u5019\u7528\u4e86Grid\uff0cie11\u4e0d\u652f\u6301\uff0c\u53ea\u80fd\u8f6c\u6210Flex\u5e03\u5c40\u3002"),Object(p.b)("pre",null,Object(p.b)("code",Object.assign({parentName:"pre"},{className:"language-tsx","data-language":"tsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token keyword">const</span> GridContainer<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> styled<span class="token punctuation">.</span>div<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n    // grid-template-columns: 300px 300px 300px;\n    // grid-template-rows: 200px 200px 200px;\n    // grid-column-gap: 20px;\n    // grid-row-gap: 20px;\n    display: flex;\n    flex-wrap: wrap;\n    max-width: 940px;\n    justify-content: space-between;\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> Card<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token function">styled</span><span class="token punctuation">(</span>Box<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token punctuation">{</span>bg<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n    width: 300px; // ++\n    height: 200px; // ++\n    position: relative;\n    background: url(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>bg<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> bg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">) no-repeat center;\n    border-radius: 3px;\n    overflow: hidden;\n    :not(:nth-child(-n + 3)) { // ++\n        margin-top: 20px; // ++\n    } // ++\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n'}}))),Object(p.b)("p",null,"\u5173\u4e8eIE\u6837\u5f0f\u7684\u5927\u90e8\u5206\u95ee\u9898\uff0c\u901a\u5e38\u53ef\u4ee5\u5c1d\u8bd5\u663e\u5f0f\u6307\u5b9a\u5bbd\u9ad8\u3002"),Object(p.b)("h2",{id:"\u767e\u5ea6\u4e91\u7f13\u5b58"},"\u767e\u5ea6\u4e91\u7f13\u5b58"),Object(p.b)("p",null,"bos \u548c cdn \u8d44\u6e90\u9ed8\u8ba4\u914d\u7f6e\u4e86 3 \u5929\u7684\u5f3a\u7f13\u5b58\u3002\u5bfc\u81f4\u8d44\u6e90\u66f4\u65b0\u4e0d\u80fd\u53ca\u65f6\u751f\u6548\uff0c\u5efa\u8bae\u914d\u7f6e\u66f4\u77ed\u7684\u5f3a\u7f13\u5b58\u65f6\u95f4\uff0c\u907f\u514d\u540c\u540d\u8d44\u6e90\u66ff\u6362\u751f\u6548\u65f6\u95f4\u8fc7\u957f\u3002"),Object(p.b)("h2",{id:"png-\u538b\u7f29"},"PNG \u538b\u7f29"),Object(p.b)("p",null,"png \u5728\u767e\u5ea6\u4e91\u56fe\u50cf\u5904\u7406\u538b\u7f29\u540e\u4f1a\u4e22\u5931 alpha \u901a\u9053\uff0c\u5bfc\u81f4\u4e00\u4e9b\u6709\u90e8\u5206\u900f\u660e\u7684\u4e3b\u8272\u4e3a\u767d\u7684\u56fe\u7247\u53d8\u6210\u5168\u767d\u3002\u56e0\u6b64\u5c3d\u91cf\u907f\u514d\u538b\u7f29 png\uff0c\u53ea\u6709\u5728\u80cc\u666f\u4e0d\u662f\u900f\u660e\u7684\u60c5\u51b5\u4e0b\u624d\u662f\u76f8\u5bf9\u5b89\u5168\u7684\u3002"),Object(p.b)("h2",{id:"unicode-\u6587\u672c\u7f16\u7801"},"unicode \u6587\u672c\u7f16\u7801"),Object(p.b)("p",null,"\u5728\u8d70\u67e5\u89c6\u89c9\u7684\u65f6\u5019\u4f1a\u53d1\u73b0\u4e00\u884c\u5b57\u4e2d\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u5b57\u4f53\u3002\u4f46\u770b\u6e90\u7801\u4e2d\u6587\u672c\u5e76\u6ca1\u6709\u4ec0\u4e48\u5b57\u4f53\u5dee\u522b\u3002\u5176\u5b9e\u6587\u6848\u4e2d\u5b58\u5728\u4e24\u79cd\u4e0d\u540c\u8303\u56f4\u7684 unicode \u7f16\u7801\u3002",Object(p.b)("a",Object.assign({parentName:"p"},{href:"https://blog.csdn.net/gstianfu/article/details/84643320"}),"\u53c2\u89c1")),Object(p.b)("p",null,"\u5176\u4e2d\u7528\u4e8e",Object(p.b)("inlineCode",{parentName:"p"},"\u90e8\u9996"),"\u7684 unicode\uff0c\u7f16\u7801\u8303\u56f4\u662f\u4ece U+2F00 \u5230 U+2FD5\u3002"),Object(p.b)("p",null,"\u53e6\u4e00\u79cd\u7528\u4e8e",Object(p.b)("inlineCode",{parentName:"p"},"\u5e38\u7528\u6c49\u5b57"),"\u7684\u7f16\u7801\u8303\u56f4\u662f U+4E00 \u5230 U+9FFF\u3002"),Object(p.b)("p",null,"\u663e\u793a\u5b57\u4f53\u4e0d\u540c\u539f\u56e0\uff1a\u5728\u67d0\u4e9b win10 \u673a\u5668\u7684\u201c\u96c5\u9ed1\u201d\u5b57\u5e93\u4e2d\u5e38\u7528\u6c49\u5b57\u5b57\u4f53\u6709\u6620\u5c04\uff0c\u53e6\u90e8\u9996\u5219\u6ca1\u6709\uff0c\u6545\u91c7\u7528\u56de\u843d\u5b57\u4f53\uff08\u7b49\u7ebf\uff09\u663e\u793a\u3002"),Object(p.b)("p",null,"\u95ee\u9898\u4ea7\u751f\u539f\u56e0\u731c\u6d4b\uff1a\u6587\u6848\u7f16\u5199\u8005\u91c7\u7528\u7684\u8f93\u5165\u6cd5\u6709\u95ee\u9898\uff0c\u672a\u6309\u7167\u5e38\u7528\u6c49\u5b57\u7684\u89c4\u8303\u5316\u7f16\u7801\u3002"),Object(p.b)("p",null,"\u76ee\u524d unicode \u6709\uff1aNFD\uff08\u9ed8\u8ba4\uff09\u3001NFC\u3001NFKD\u3001NFKC \u56db\u79cd\u89c4\u8303\u5316\u5f62\u5f0f\u3002\u82f1\u6587\u548c\u4e00\u4e9b\u90e8\u9996\u91c7\u7528 NFD\u3001NFC\uff0c\u800c\u5e38\u7528\u6c49\u5b57\u91c7\u7528 NFKD\u3001NFKC \u5f62\u5f0f\u3002"),Object(p.b)("p",null,"\u89e3\u51b3\u601d\u8def\uff1a\u5c06\u90e8\u9996\u8f6c\u6362\u5230\u5e38\u7528\u6c49\u5b57\u7f16\u7801\u8303\u56f4\u3002\u6bd4\u5982\u90fd\u8f6c\u6362\u6210 NFKD\u3002"),Object(p.b)("p",null,"ES6 \u4e2d\u63d0\u4f9b\u4e86\u5de5\u5177\u51fd\u6570",Object(p.b)("a",Object.assign({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize"}),"String.prototype.normalize()"),"\uff0c\u53ef\u4ee5\u4f20\u5165\u53c2\u6570",Object(p.b)("inlineCode",{parentName:"p"},'"NFKD"'),"\u3002"),Object(p.b)("h2",{id:"\u5e27\u52a8\u753b\u5b9e\u73b0"},"\u5e27\u52a8\u753b\u5b9e\u73b0"),Object(p.b)("p",null,"\u53ef\u6539\u8fdb\u7684\u70b9\uff1a\u51cf\u5c11\u56fe\u7247\u8bf7\u6c42\u6570\u91cf\u3001\u91c7\u7528RAF\u66ff\u4ee3 setTimeout\u3001\u4ece\u53ef\u89c1\u6027\u65b9\u9762\u8282\u80fd\u3002"),Object(p.b)("p",null,"\u4ee3\u7801\u5982\u4e0b\uff1a"),Object(p.b)("pre",null,Object(p.b)("code",Object.assign({parentName:"pre"},{className:"language-tsx","data-language":"tsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token comment">/**\n * @file [FrameAnimate]\n * @author [mzvast]\n * @email [mzvast@gmail.com]\n * @create date 2020-10-10 17:40:42\n */</span>\n<span class="token comment">/* eslint-disable max-len,babel/new-cap,operator-linebreak,fecs-export-on-declare,space-before-function-paren */</span>\n<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>PureComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span>styled<span class="token punctuation">,</span> css<span class="token punctuation">,</span> keyframes<span class="token punctuation">,</span> Box<span class="token punctuation">,</span> palette<span class="token punctuation">,</span> Flex<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'galaco\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> getBosPicUrl <span class="token keyword">from</span> <span class="token string">\'common/getBosPicUrl\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span>flexCenter<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">\'components/sharedStyle\'</span><span class="token punctuation">;</span>\n\n<span class="token comment">// borrowed from by https://www.zhangxinxu.com/study/201805/image-sequence-frame-play.html</span>\n\n<span class="token comment">// 24 fps=> 42ms per img</span>\n<span class="token keyword">const</span> Container<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token function">styled</span><span class="token punctuation">(</span>Box<span class="token punctuation">)</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n    cursor: default;\n    img {\n        min-width: 100%;\n        min-height: 100%;\n    }\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> PuppyContainer<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> styled<span class="token punctuation">.</span>img<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n    flex-shrink: 0;\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> TextWrap<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token function">styled</span><span class="token punctuation">(</span>flexCenter<span class="token punctuation">)</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n    flex-direction: column;\n    position: absolute;\n    top: 240px;\n    width: 100%;\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> BigText<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token function">styled</span><span class="token punctuation">(</span>Box<span class="token punctuation">)</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n    font-family: PingFangSC-Medium;\n    font-size: 62px;\n    color: #ffffff;\n    line-height: 60px;\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> SmallText<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token function">styled</span><span class="token punctuation">(</span>Box<span class="token punctuation">)</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n    font-family: PingFangSC-Regular;\n    font-size: 18px;\n    color: #ffffff;\n    letter-spacing: 0;\n    line-height: 24px;\n    margin-top: 30px;\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token punctuation">{</span>\n    big<span class="token punctuation">:</span> <span class="token string">\'BIG_TEXT\'</span><span class="token punctuation">,</span>\n    small<span class="token punctuation">:</span> <span class="token string">\'SMALL_TEXT\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">type</span> Props <span class="token operator">=</span> <span class="token punctuation">{</span>\n    urlRoot<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n    indexRange<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// \u52a8\u753b\u5e27\u8303\u56f4eg,[1,143]</span>\n    visible<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> <span class="token comment">// \u5f53\u524d\u72b6\u6001\u662f\u5426\u7528\u6237\u53ef\u89c1\uff0c\u7528\u4e8e\u63a7\u5236\u8d77\u505c</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">type</span> State <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">class</span> <span class="token class-name">FrameAnimate</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span><span class="token operator">&lt;</span>Props<span class="token punctuation">,</span> State<span class="token operator">></span> <span class="token punctuation">{</span>\n    state<span class="token punctuation">:</span> State<span class="token punctuation">;</span>\n\n    <span class="token keyword">static</span> defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    store <span class="token operator">=</span> <span class="token punctuation">{</span>length<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    pendingStore <span class="token operator">=</span> <span class="token punctuation">{</span>length<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    maxLength<span class="token punctuation">;</span>\n    eleContainer<span class="token punctuation">;</span>\n    elPuppy<span class="token punctuation">;</span>\n    timer<span class="token punctuation">;</span>\n    isPlaying <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// flag</span>\n    lastIndex<span class="token punctuation">;</span> <span class="token comment">// for reset use only</span>\n\n    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token punctuation">(</span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Container</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="token plain-text">                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Flex</span></span> <span class="token attr-name">use</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>flexCenter<span class="token punctuation">}</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="token plain-text">                    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">PuppyContainer</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>puppy<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span>\n<span class="token plain-text">                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Flex</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="token plain-text">                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TextWrap</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="token plain-text">                    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">BigText</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>text<span class="token punctuation">.</span>big<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">BigText</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="token plain-text">                    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SmallText</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>text<span class="token punctuation">.</span>small<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">SmallText</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="token plain-text">                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TextWrap</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>\n<span class="token plain-text">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Container</span></span><span class="token punctuation">></span></span>\n        <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>eleContainer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'container\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>elPuppy <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">\'puppy\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">insertPlaceholder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">prefetchImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">&amp;&amp;</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clearAllPendingImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function-variable function">setSrc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">idx<span class="token punctuation">,</span> force <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token comment">// idx===0 \u5360\u4f4d\u56fe</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>force <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>elPuppy<span class="token punctuation">.</span>prevIdx <span class="token operator">===</span> idx <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">return</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">let</span> src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getOptUrl</span><span class="token punctuation">(</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>urlRoot <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">\'000\'</span> <span class="token operator">+</span> idx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">\'.png\'</span>\n        <span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// console.log(\'ddt::setSrc,idx\', idx);</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>elPuppy<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>elPuppy<span class="token punctuation">.</span>prevIdx <span class="token operator">=</span> idx<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="highlighted-line">    <span class="token comment">// \u4e0d\u5efa\u8bae\u4f7f\u7528cwrp\u63a5\u53e3</span></span><span class="highlighted-line">    <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>        <span class="token comment">// console.log(</span>\n        <span class="token comment">//     \'ddt::prevProps.visible,this.props.visible\',</span>\n        <span class="token comment">//     prevProps.visible,</span>\n        <span class="token comment">//     this.props.visible</span>\n        <span class="token comment">// );</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>prevProps<span class="token punctuation">.</span>visible <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>visible<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function-variable function">getOptUrl</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> getBosPicUrl<span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// \u5360\u4f4d\u56fe</span>\n    <span class="token function-variable function">insertPlaceholder</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token comment">// may have some latency due to network speed</span>\n        <span class="token keyword">const</span> <span class="token punctuation">{</span>indexRange<span class="token punctuation">,</span> urlRoot<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">/**\n     *  \u56fe\u7247\u9884\u52a0\u8f7dtask manage\u76f8\u5173-start\n     * */</span>\n    <span class="token function-variable function">addPendingImg</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">idx<span class="token punctuation">,</span> img</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>pendingStore<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> img<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function-variable function">removePendingImg</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">idx</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pendingStore<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pendingStore<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function-variable function">clearAllPendingImg</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> idx <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pendingStore<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pendingStore<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pendingStore<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>src<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                    <span class="token keyword">this</span><span class="token punctuation">.</span>pendingStore<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n                    <span class="token keyword">this</span><span class="token punctuation">.</span>pendingStore<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n                    <span class="token keyword">this</span><span class="token punctuation">.</span>pendingStore<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">\'\'</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removePendingImg</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token comment">/**\n     *  \u56fe\u7247\u9884\u52a0\u8f7dtask manage\u76f8\u5173-end\n     * */</span>\n\n    <span class="token comment">// \u9884\u52a0\u8f7d\u56fe\u7247\u5230\u5185\u5b58</span>\n    <span class="token function-variable function">prefetchImg</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> <span class="token punctuation">{</span>indexRange<span class="token punctuation">,</span> urlRoot<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength <span class="token operator">=</span> indexRange<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> indexRange<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>\n        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> idx <span class="token operator">=</span> indexRange<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> idx <span class="token operator">&lt;=</span> indexRange<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> idx<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">let</span> src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getOptUrl</span><span class="token punctuation">(</span>\n                urlRoot <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">\'000\'</span> <span class="token operator">+</span> idx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">\'.png\'</span>\n            <span class="token punctuation">)</span><span class="token punctuation">;</span>\n            img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n                <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span>length<span class="token operator">++</span><span class="token punctuation">;</span>\n                <span class="token comment">// \u5b58\u50a8\u9884\u52a0\u8f7d\u7684\u56fe\u7247\u5bf9\u8c61</span>\n                <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> img<span class="token punctuation">;</span>\n                img<span class="token punctuation">.</span>src <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removePendingImg</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">;</span>\n            img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n                <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span>length<span class="token operator">++</span><span class="token punctuation">;</span>\n                img<span class="token punctuation">.</span>src <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removePendingImg</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">;</span>\n            img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addPendingImg</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function-variable function">play</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> <span class="token punctuation">{</span>indexRange<span class="token punctuation">,</span> urlRoot<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>\n        <span class="token keyword">const</span> percent <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxLength<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// \u9884\u52a0\u8f7d\u5b8c\u6bd5\u540e\u5f00\u59cb\u52a8\u753b\uff0c\u9632\u91cd\u5165</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>percent <span class="token operator">==</span> <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isPlaying<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span>isPlaying <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n            <span class="token keyword">let</span> index <span class="token operator">=</span> indexRange<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n            <span class="token comment">// \u4f9d\u6b21append\u56fe\u7247\u5bf9\u8c61</span>\n            <span class="token keyword">const</span> <span class="token function-variable function">step</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isPlaying <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>visible<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                    <span class="token keyword">return</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token keyword">this</span><span class="token punctuation">.</span>lastIndex <span class="token operator">=</span> index<span class="token punctuation">;</span> <span class="token comment">// remember last inserted index</span>\n                <span class="token comment">// \u5e8f\u5217\u589e\u52a0</span>\n                index<span class="token operator">++</span><span class="token punctuation">;</span>\n                <span class="token comment">// \u5982\u679c\u8d85\u8fc7\u6700\u5927\u9650\u5236</span>\n                <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;=</span> indexRange<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                    <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>step<span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n                    <span class="token comment">// \u672c\u6bb5\u64ad\u653e\u7ed3\u675f\u56de\u8c03</span>\n                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span><span class="token punctuation">;</span>\n            <span class="token comment">// \u7b49100%\u52a8\u753b\u7ed3\u675f\u540e\u6267\u884c\u64ad\u653e</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n                <span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// \u91cd\u7f6e</span>\n    <span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isPlaying<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>isPlaying <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n        <span class="token keyword">const</span> <span class="token punctuation">{</span>indexRange<span class="token punctuation">,</span> urlRoot<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">&amp;&amp;</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> FrameAnimate<span class="token punctuation">;</span>\n'}}))))}l.isMDXComponent=!0;var u=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[{id:"\u5e27\u52a8\u753b\u95ea\u70c1\u548c\u6d4f\u89c8\u5668\u517c\u5bb9\u6027",level:2,title:"\u5e27\u52a8\u753b\u95ea\u70c1\u548c\u6d4f\u89c8\u5668\u517c\u5bb9\u6027",children:[]},{id:"webpack-\u4e0e\u8c03\u8bd5-es5",level:2,title:"webpack \u4e0e\u8c03\u8bd5 es5",children:[]},{id:"ie11-css\u517c\u5bb9\u6027\u76f8\u5173",level:2,title:"IE11 CSS\u517c\u5bb9\u6027\u76f8\u5173",children:[]},{id:"\u767e\u5ea6\u4e91\u7f13\u5b58",level:2,title:"\u767e\u5ea6\u4e91\u7f13\u5b58",children:[]},{id:"png-\u538b\u7f29",level:2,title:"PNG \u538b\u7f29",children:[]},{id:"unicode-\u6587\u672c\u7f16\u7801",level:2,title:"unicode \u6587\u672c\u7f16\u7801",children:[]},{id:"\u5e27\u52a8\u753b\u5b9e\u73b0",level:2,title:"\u5e27\u52a8\u753b\u5b9e\u73b0",children:[]}]},i={}}}]);
//# sourceMappingURL=112.94daf0d5.chunk.js.map