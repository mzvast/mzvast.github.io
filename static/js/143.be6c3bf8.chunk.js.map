{"version":3,"sources":["routes/posts/2022/06/21-1725-omni-outliner-plugin-try-try/document.mdx"],"names":["readingTime","text","minutes","time","words","layoutProps","MDXLayout","MDXContent","_ref","components","props","Object","_home_runner_work_mzvast_github_io_mzvast_github_io_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","_mdx_js_react__WEBPACK_IMPORTED_MODULE_2__","assign","mdxType","id","parentName","href","className","data-language","data-highlighted-line-numbers","dangerouslySetInnerHTML","__html","isMDXComponent","tableOfContents","arguments","length","undefined","level","title","children","frontMatter"],"mappings":"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","file":"static/js/143.be6c3bf8.chunk.js","sourcesContent":["\nimport React from 'react'\nimport { mdx } from '@mdx-js/react'\nexport const readingTime = {\"text\":\"3 min read\",\"minutes\":2.035,\"time\":122100.00000000001,\"words\":407}\n/* @jsx mdx */\n\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  \n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h2 {...{\n      \"id\": \"你可以从本文了解到\"\n    }}>{`你可以从本文了解到`}</h2>\n    <h3 {...{\n      \"id\": \"背景\"\n    }}>{`背景`}</h3>\n    <p>{`习惯是一个人的迭代系统，好的习惯可以帮助我们在生活和工作中更好的成长。`}</p>\n    <p>{`我平时有记工作日志的习惯，Omin Outliner是一款大纲软件，能够实现任意层级深度的结构，用于记录工作事项和复盘都非常方便。`}</p>\n    <p>{`我平时的日志主要下面这样的结构。`}</p>\n    <p>{`可以简化成`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`2022-10 【月】\n    10.3-10.7 【周】\n        10.3【日】\n        10.4【日】\n        10.5【日】\n        10.6【日】\n        10.7【日】\n            TOP3【三件最重要的事】\n            🧙‍♀️🐟【学到的新知识】\n`}</code></pre>\n    <p>{`整体看上去是非常结构化，并且可以自动化的。`}</p>\n    <p>{`之前我都是低效率的手动录入每周，之前一直就在想等有空了一定要自动化。`}</p>\n    <p>{`那么我们来实现一下这个功能。`}</p>\n    <h3 {...{\n      \"id\": \"基本概念\"\n    }}>{`基本概念`}</h3>\n    <h4 {...{\n      \"id\": \"1、文档\"\n    }}>{`1、文档`}</h4>\n    <p>{`首先OO的文档整体的基本概念可以参考`}<a parentName=\"p\" {...{\n        \"href\": \"https://omni-automation.com/omnioutliner/item.html\"\n      }}>{`官网`}</a>{`，咱们主要是用到2个概念。`}</p>\n    <p>{`1、Document，即整个文件`}</p>\n    <p>{`2、Item，用户选中的节点或节点组`}</p>\n    <h4 {...{\n      \"id\": \"2、插件\"\n    }}>{`2、插件`}</h4>\n    <p>{`OO的插件是写在一个IIFE中，返回的就是这个action，OO会将顶部注释的内容和这段插件代码进行关联，比如增加菜单和快捷入口等。`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-jsx\",\n        \"data-language\": \"jsx\",\n        \"data-highlighted-line-numbers\": \"\",\n        \"dangerouslySetInnerHTML\": {\n          \"__html\": \"<span class=\\\"token comment\\\">/*{\\n    \\\"author\\\": \\\"mzvast\\\",\\n    \\\"targets\\\": [\\\"omnioutliner\\\"],\\n    \\\"type\\\": \\\"action\\\",\\n    \\\"identifier\\\": \\\"com.mycompany.createPlanFromMonth\\\",\\n    \\\"version\\\": \\\"0.1\\\",\\n    \\\"description\\\": \\\"A plug-in that...\\\",\\n    \\\"label\\\": \\\"createPlanFromMonth\\\",\\n    \\\"mediumLabel\\\": \\\"createPlanFromMonth\\\",\\n    \\\"longLabel\\\": \\\"createPlanFromMonth\\\",\\n    \\\"paletteLabel\\\": \\\"createPlanFromMonth\\\",\\n}*/</span>\\n<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">var</span> action <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">PlugIn<span class=\\\"token punctuation\\\">.</span>Action</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">selection</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    \\n      <span class=\\\"token comment\\\">// 你的代码</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> action<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\"\n        }\n      }}></code></pre>\n    <h3 {...{\n      \"id\": \"插件设计和实现\"\n    }}>{`插件设计和实现`}</h3>\n    <p>{`首先这是`}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/mzvast/omnijs/blob/master/outliner/createPlanFromMonth.omnijs\"\n      }}>{`最终代码`}</a>{`。`}</p>\n    <p>{`整体就是要做下面这些事。`}</p>\n    <p>{`1、输入一个或多个月份，生成工作日数据结构。相当于产生VDOM。（纯JS）`}</p>\n    <p>{`2、将上一部生成的工作日数组插入到文档中去。相当于VDOM转换成OO的对象。（使用OO API）`}</p>\n    <p>{`首先来看第一部分纯JS代码，生成工作日数据结构，这部分比较简单，主要是要注意几个边界条件，问题不大。`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-jsx\",\n        \"data-language\": \"jsx\",\n        \"data-highlighted-line-numbers\": \"\",\n        \"dangerouslySetInnerHTML\": {\n          \"__html\": \" <span class=\\\"token comment\\\">// 输入</span>\\n<span class=\\\"token comment\\\">// 2022-06 </span>\\n<span class=\\\"token comment\\\">// 输出</span>\\n<span class=\\\"token comment\\\">// ans = [</span>\\n<span class=\\\"token comment\\\">//     ['6.1', '6.2', '6.3'],</span>\\n<span class=\\\"token comment\\\">//     ['6.5', '6.6', '6.7', '6.8', '6.9'],</span>\\n<span class=\\\"token comment\\\">// ];</span>\\n<span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">generateCalender</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">itemValue</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">const</span> startPoint <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Date</span><span class=\\\"token punctuation\\\">(</span>itemValue<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> y <span class=\\\"token operator\\\">=</span> startPoint<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getFullYear</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> m <span class=\\\"token operator\\\">=</span> startPoint<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getMonth</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// 月</span>\\n        <span class=\\\"token keyword\\\">const</span> d <span class=\\\"token operator\\\">=</span> startPoint<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getDate</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// 日</span>\\n\\n        <span class=\\\"token keyword\\\">const</span> ans <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">let</span> tmp <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">while</span> <span class=\\\"token punctuation\\\">(</span>\\n            startPoint<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getMonth</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">1</span> <span class=\\\"token operator\\\">&lt;=</span> m <span class=\\\"token operator\\\">&amp;&amp;</span>\\n            startPoint<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getFullYear</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">===</span> y\\n          <span class=\\\"token comment\\\">// 当前日期还在本月，继续循环</span>\\n        <span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">const</span> day <span class=\\\"token operator\\\">=</span> startPoint<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getDay</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>day <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">6</span> <span class=\\\"token operator\\\">&amp;&amp;</span> day <span class=\\\"token operator\\\">></span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                tmp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">push</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token template-punctuation string\\\">`</span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>m<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">.</span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>startPoint<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getDate</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token template-punctuation string\\\">`</span></span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// 插入工作日到tmp</span>\\n            <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">else</span> <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>tmp<span class=\\\"token punctuation\\\">.</span>length<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                ans<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">push</span><span class=\\\"token punctuation\\\">(</span>tmp<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// 将tmp插入ans</span>\\n                tmp <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            startPoint<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setDate</span><span class=\\\"token punctuation\\\">(</span>startPoint<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getDate</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// 增加一天</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n\\n        <span class=\\\"token keyword\\\">return</span> ans<span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\"\n        }\n      }}></code></pre>\n    <p>{`然后就要处理第二部分了。也没什么复杂的逻辑，看注释就可以了解。`}</p>\n    <p>{`关键是用到几个API`}</p>\n    <p>{`1、`}<inlineCode parentName=\"p\">{`document.editors[0].selectedNodes`}</inlineCode>{`获取当前选中的节点list`}</p>\n    <p>{`2、`}<inlineCode parentName=\"p\">{`document.outline.outlineColumn`}</inlineCode>{`当前focus的列，一行一列就确定了单元格`}</p>\n    <p>{`3、`}<inlineCode parentName=\"p\">{`selectedItem.valueForColumn(targetColumn).string`}</inlineCode>{`获取某个单元格的内容`}</p>\n    <p>{`4、`}<inlineCode parentName=\"p\">{`selectedItem.addChild`}</inlineCode>{`向一个item插入子节点，其中第一个参数表示插入位置，end表示插入到末尾。`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-jsx\",\n        \"data-language\": \"jsx\",\n        \"data-highlighted-line-numbers\": \"\",\n        \"dangerouslySetInnerHTML\": {\n          \"__html\": \"<span class=\\\"token comment\\\">/*{\\n    \\\"author\\\": \\\"mzvast\\\",\\n    \\\"targets\\\": [\\\"omnioutliner\\\"],\\n    \\\"type\\\": \\\"action\\\",\\n    \\\"identifier\\\": \\\"com.mycompany.createPlanFromMonth\\\",\\n    \\\"version\\\": \\\"0.1\\\",\\n    \\\"description\\\": \\\"A plug-in that...\\\",\\n    \\\"label\\\": \\\"createPlanFromMonth\\\",\\n    \\\"mediumLabel\\\": \\\"createPlanFromMonth\\\",\\n    \\\"longLabel\\\": \\\"createPlanFromMonth\\\",\\n    \\\"paletteLabel\\\": \\\"createPlanFromMonth\\\",\\n}*/</span>\\n<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">var</span> action <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">PlugIn<span class=\\\"token punctuation\\\">.</span>Action</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">selection</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">var</span> selectedItems <span class=\\\"token operator\\\">=</span> document<span class=\\\"token punctuation\\\">.</span>editors<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">.</span>selectedNodes<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">map</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>\\n            <span class=\\\"token parameter\\\">node</span>\\n        <span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">return</span> node<span class=\\\"token punctuation\\\">.</span>object<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                \\n      <span class=\\\"token comment\\\">// 同时支持单选和多选</span>\\n        selectedItems<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">forEach</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">item</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token function\\\">processItem</span><span class=\\\"token punctuation\\\">(</span>item<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token comment\\\">// 处理一条记录</span>\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">processItem</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">selectedItem</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n     \\n        <span class=\\\"token keyword\\\">var</span> targetColumn <span class=\\\"token operator\\\">=</span> document<span class=\\\"token punctuation\\\">.</span>outline<span class=\\\"token punctuation\\\">.</span>outlineColumn<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// 获取当前的列</span>\\n        <span class=\\\"token keyword\\\">var</span> itemValue <span class=\\\"token operator\\\">=</span> selectedItem<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">valueForColumn</span><span class=\\\"token punctuation\\\">(</span>targetColumn<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>string<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// 当前单元格的内容</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Invoked with selection'</span><span class=\\\"token punctuation\\\">,</span> itemValue<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token comment\\\">// 2022-1,2022-01</span>\\n        <span class=\\\"token comment\\\">// 数据校验</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token regex\\\">/\\\\d{4}-\\\\d{2}/i</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">test</span><span class=\\\"token punctuation\\\">(</span>itemValue<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Alert</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'bad date, expect YYYY-MM'</span><span class=\\\"token punctuation\\\">,</span> itemValue<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">show</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">result</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">return</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n\\n        <span class=\\\"token comment\\\">// 输入</span>\\n        <span class=\\\"token comment\\\">// 2022-06</span>\\n        <span class=\\\"token comment\\\">// getDay 0周日 1周一..6周六</span>\\n\\n        <span class=\\\"token keyword\\\">const</span> ans <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">generateCalender</span><span class=\\\"token punctuation\\\">(</span>itemValue<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token comment\\\">// 最终的数据结构</span>\\n        <span class=\\\"token comment\\\">// ans = [</span>\\n        <span class=\\\"token comment\\\">//     ['6.1', '6.2', '6.3'],</span>\\n        <span class=\\\"token comment\\\">//     ['6.5', '6.6', '6.7', '6.8', '6.9'],</span>\\n        <span class=\\\"token comment\\\">// ];</span>\\n\\n        <span class=\\\"token comment\\\">// renderer</span>\\n        <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> i <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">&lt;</span> ans<span class=\\\"token punctuation\\\">.</span>length<span class=\\\"token punctuation\\\">;</span> i<span class=\\\"token operator\\\">++</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token comment\\\">// i=> week</span>\\n            <span class=\\\"token keyword\\\">const</span> week <span class=\\\"token operator\\\">=</span> selectedItem<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">addChild</span><span class=\\\"token punctuation\\\">(</span>\\n                selectedItem<span class=\\\"token punctuation\\\">.</span>end<span class=\\\"token punctuation\\\">,</span>\\n                <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">item</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    item<span class=\\\"token punctuation\\\">.</span>topic <span class=\\\"token operator\\\">=</span><span class=\\\"token template-string\\\"><span class=\\\"token template-punctuation string\\\">`</span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>ans<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">-</span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>ans<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>ans<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">.</span>length <span class=\\\"token operator\\\">-</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token template-punctuation string\\\">`</span></span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">let</span> j <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> j <span class=\\\"token operator\\\">&lt;</span> ans<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">.</span>length<span class=\\\"token punctuation\\\">;</span> j<span class=\\\"token operator\\\">++</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">const</span> day <span class=\\\"token operator\\\">=</span> week<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">addChild</span><span class=\\\"token punctuation\\\">(</span>week<span class=\\\"token punctuation\\\">.</span>end<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">item</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    item<span class=\\\"token punctuation\\\">.</span>topic <span class=\\\"token operator\\\">=</span> ans<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">[</span>j<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                day<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">addChild</span><span class=\\\"token punctuation\\\">(</span>day<span class=\\\"token punctuation\\\">.</span>end<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">item</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    item<span class=\\\"token punctuation\\\">.</span>topic <span class=\\\"token operator\\\">=</span> <span class=\\\"token string\\\">'TOP3'</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                day<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">addChild</span><span class=\\\"token punctuation\\\">(</span>day<span class=\\\"token punctuation\\\">.</span>end<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">item</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    item<span class=\\\"token punctuation\\\">.</span>topic <span class=\\\"token operator\\\">=</span> <span class=\\\"token string\\\">'🧙‍♀️🐟'</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">generateCalender</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">itemValue</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token comment\\\">// ...</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> action<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\"\n        }\n      }}></code></pre>\n    <h3 {...{\n      \"id\": \"总结\"\n    }}>{`总结`}</h3>\n    <p>{`这款插件在使得之后个人工作日志的迭代效率更max了。`}</p>\n    <p>{`借此机会还深入了解了OO的文档结构和API，以后开发类似的插件就会更得心应手。`}</p>\n    <p>{`也希望本文可以帮到对OO 插件感兴趣的同学。`}</p>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;\nexport const tableOfContents = (components={}) => [\n  {\n    id: \"你可以从本文了解到\",\n    level: 2,\n    title: \"你可以从本文了解到\",\n    children: [\n        {\n              id: \"背景\",\n              level: 3,\n              title: \"背景\",\n              children: [\n                      \n                    ]\n            },\n      {\n              id: \"基本概念\",\n              level: 3,\n              title: \"基本概念\",\n              children: [\n                      \n                    ]\n            },\n      {\n              id: \"插件设计和实现\",\n              level: 3,\n              title: \"插件设计和实现\",\n              children: [\n                      \n                    ]\n            },\n      {\n              id: \"总结\",\n              level: 3,\n              title: \"总结\",\n              children: [\n                      \n                    ]\n            }\n      ]\n  }\n]\n\nexport const frontMatter = {}\n\n"],"sourceRoot":""}