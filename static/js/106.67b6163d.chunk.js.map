{"version":3,"sources":["routes/posts/2019/12/11-cra-polyfill/document.mdx"],"names":["readingTime","text","minutes","time","words","layoutProps","MDXLayout","MDXContent","_ref","components","props","Object","_home_runner_work_mzvast_github_io_mzvast_github_io_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","_mdx_js_react__WEBPACK_IMPORTED_MODULE_2__","assign","mdxType","id","parentName","href","className","data-language","data-highlighted-line-numbers","dangerouslySetInnerHTML","__html","isMDXComponent","tableOfContents","arguments","length","undefined","level","title","children","frontMatter"],"mappings":"sSAGaA,EAAc,CAACC,KAAO,aAAaC,QAAU,IAAKC,KAAO,MAAMC,MAAQ,IAS9EC,EAAc,GAGdC,EAAY,UACH,SAASC,EAATC,GAGZ,IAFDC,EAECD,EAFDC,WACGC,EACFC,OAAAC,EAAA,EAAAD,CAAAH,EAAA,gBACD,OAAOG,OAAAE,EAAA,EAAAF,CAACL,EAADK,OAAAG,OAAA,GAAeT,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYM,QAAQ,cAC5EJ,OAAAE,EAAA,EAAAF,CAAA,uiBAEAA,OAAAE,EAAA,EAAAF,CAAA,KAAQ,CACNK,GAAM,gIADR,gIAGAL,OAAAE,EAAA,EAAAF,CAAA,yBAAUA,OAAAE,EAAA,EAAAF,CAAA,IAAAA,OAAAG,OAAA,CAAGG,WAAW,KAAQ,CAC5BC,KAAQ,mEADF,mBAAV,uPAGAP,OAAAE,EAAA,EAAAF,CAAA,4jBACAA,OAAAE,EAAA,EAAAF,CAAA,iSAGAA,OAAAE,EAAA,EAAAF,CAAA,KAAQ,CACNK,GAAM,oBADR,oBAGAL,OAAAE,EAAA,EAAAF,CAAA,mEACAA,OAAAE,EAAA,EAAAF,CAAA,gBACAA,OAAAE,EAAA,EAAAF,CAAA,WAAKA,OAAAE,EAAA,EAAAF,CAAA,OAAAA,OAAAG,OAAA,CAAMG,WAAW,OAAU,CAC5BE,UAAa,sBACbC,gBAAiB,aACjBC,gCAAiC,GACjCC,wBAA2B,CACzBC,OAAU,uIAGhBZ,OAAAE,EAAA,EAAAF,CAAA,kDACAA,OAAAE,EAAA,EAAAF,CAAA,WAAKA,OAAAE,EAAA,EAAAF,CAAA,OAAAA,OAAAG,OAAA,CAAMG,WAAW,OAAU,CAC5BE,UAAa,sBACbC,gBAAiB,aACjBC,gCAAiC,GACjCC,wBAA2B,CACzBC,OAAU,4TAGhBZ,OAAAE,EAAA,EAAAF,CAAA,KAAQ,CACNK,GAAM,gBADR,gBAGAL,OAAAE,EAAA,EAAAF,CAAA,qEACAA,OAAAE,EAAA,EAAAF,CAAA,WAAKA,OAAAE,EAAA,EAAAF,CAAA,OAAAA,OAAAG,OAAA,CAAMG,WAAW,OAAU,CAC5BE,UAAa,gBACbC,gBAAiB,OACjBC,gCAAiC,GACjCC,wBAA2B,CACzBC,OAAU,iuCAGhBZ,OAAAE,EAAA,EAAAF,CAAA,SAAGA,OAAAE,EAAA,EAAAF,CAAA,IAAAA,OAAAG,OAAA,CAAGG,WAAW,KAAQ,CACrBC,KAAQ,oFADT,4BAAH,iHAGAP,OAAAE,EAAA,EAAAF,CAAA,mIACAA,OAAAE,EAAA,EAAAF,CAAA,KAAQ,CACNK,GAAM,2DADR,4DAOJT,EAAWiB,gBAAiB,EACrB,IAAMC,EAAkB,WAAAC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,SAAmB,CAChD,CACEV,GAAI,+HACJa,MAAO,EACPC,MAAO,+HACPC,SAAU,CACN,CACMf,GAAI,mBACJa,MAAO,EACPC,MAAO,mBACPC,SAAU,IAIlB,CACQf,GAAI,eACJa,MAAO,EACPC,MAAO,eACPC,SAAU,MAMxB,CACIf,GAAI,0DACJa,MAAO,EACPC,MAAO,0DACPC,SAAU,MAMDC,EAAc","file":"static/js/106.67b6163d.chunk.js","sourcesContent":["\nimport React from 'react'\nimport { mdx } from '@mdx-js/react'\nexport const readingTime = {\"text\":\"1 min read\",\"minutes\":0.37,\"time\":22200,\"words\":74}\n/* @jsx mdx */\n\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  \n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <p>{`浏览器兼容性是老生常谈了，以往都是直接引入babel-polyfill完事。这样造成包体积变大了很多，因为照顾少数浏览器的体验而使得优秀的浏览器体验也跟着变差了。\n以create-react-app为例，本文探讨目前polyfill的几种姿势。`}</p>\n    <h2 {...{\n      \"id\": \"1、生成一个精确支持浏览器的包（cra官方姿势）\"\n    }}>{`1、生成一个精确支持浏览器的包（CRA官方姿势）`}</h2>\n    <p>{` 纵观`}<a parentName=\"p\" {...{\n        \"href\": \"https://create-react-app.dev/docs/supported-browsers-features/\"\n      }}>{`CRA文档`}</a>{`浏览器支持部分。看完可能不清楚“Supported Language Features”和“Configuring Supported Browsers“为什么会分两节来叙述。`}</p>\n    <p>{`其实这两节的内在逻辑是““Supported Language Features”是提供了polyfill，“Configuring Supported Browsers“是按需（目标浏览器的支持度）裁剪了polyfill的内容。也就是前者是全集（直接引入全部补丁），后者是子集（干掉浏览器已经支持的补丁）。`}</p>\n    <p>{`需要做两件事：\n1、在entrypint（即在index.tsx中）导入core-js（第一节的内容）\n2、配置好正确的browserlist（第二节的内容）`}</p>\n    <h3 {...{\n      \"id\": \"babel-preset-env\"\n    }}>{`babel-preset-env`}</h3>\n    <p>{`会做类似以下的事情`}</p>\n    <p>{`In:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\",\n        \"data-language\": \"javascript\",\n        \"data-highlighted-line-numbers\": \"\",\n        \"dangerouslySetInnerHTML\": {\n          \"__html\": \"<span class=\\\"token keyword\\\">import</span> <span class=\\\"token string\\\">\\\"core-js\\\"</span><span class=\\\"token punctuation\\\">;</span>\\n\"\n        }\n      }}></code></pre>\n    <p>{`Out (different based on environment):`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\",\n        \"data-language\": \"javascript\",\n        \"data-highlighted-line-numbers\": \"\",\n        \"dangerouslySetInnerHTML\": {\n          \"__html\": \"<span class=\\\"token keyword\\\">import</span> <span class=\\\"token string\\\">\\\"core-js/modules/es.string.pad-start\\\"</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token string\\\">\\\"core-js/modules/es.string.pad-end\\\"</span><span class=\\\"token punctuation\\\">;</span>\\n\"\n        }\n      }}></code></pre>\n    <h3 {...{\n      \"id\": \"browserslist\"\n    }}>{`browserslist`}</h3>\n    <p>{`帮助筛选polyfill的去留。`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\",\n        \"data-language\": \"json\",\n        \"data-highlighted-line-numbers\": \"\",\n        \"dangerouslySetInnerHTML\": {\n          \"__html\": \"<span class=\\\"token property\\\">\\\"browserslist\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token property\\\">\\\"production\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n            <span class=\\\"token string\\\">\\\">0.2%\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n            <span class=\\\"token string\\\">\\\"not dead\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n            <span class=\\\"token string\\\">\\\"not op_mini all\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n            <span class=\\\"token string\\\">\\\"ios_saf 10\\\"</span>\\n        <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n        <span class=\\\"token property\\\">\\\"development\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n            <span class=\\\"token string\\\">\\\"last 1 chrome version\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n            <span class=\\\"token string\\\">\\\"last 1 firefox version\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n            <span class=\\\"token string\\\">\\\"last 1 safari version\\\"</span>\\n        <span class=\\\"token punctuation\\\">]</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\"\n        }\n      }}></code></pre>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://browsersl.ist/?q=%3E0.2%25%2C+not+dead%2C+not+op_mini+all%2C+ios_saf+10\"\n      }}>{`这个站点`}</a>{`,可以直观的帮助我们看到适配的浏览器。`}</p>\n    <p>{`两者的互动关系，具体的实现有待研究（todo）`}</p>\n    <h2 {...{\n      \"id\": \"2、按需加载polyfill（todo）\"\n    }}>{`2、按需加载polyfill（todo）`}</h2>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;\nexport const tableOfContents = (components={}) => [\n  {\n    id: \"1、生成一个精确支持浏览器的包（cra官方姿势）\",\n    level: 2,\n    title: \"1、生成一个精确支持浏览器的包（CRA官方姿势）\",\n    children: [\n        {\n              id: \"babel-preset-env\",\n              level: 3,\n              title: \"babel-preset-env\",\n              children: [\n                      \n                    ]\n            },\n      {\n              id: \"browserslist\",\n              level: 3,\n              title: \"browserslist\",\n              children: [\n                      \n                    ]\n            }\n      ]\n  },\n{\n    id: \"2、按需加载polyfill（todo）\",\n    level: 2,\n    title: \"2、按需加载polyfill（todo）\",\n    children: [\n        \n      ]\n  }\n]\n\nexport const frontMatter = {}\n\n"],"sourceRoot":""}